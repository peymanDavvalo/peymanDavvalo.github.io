

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Linear 1D Advection Equation &mdash; Diff. Academy 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="licence" href="licence.html" />
    <link rel="prev" title="Welcome to Diff. Academy’s documentation!" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Diff. Academy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Linear 1D Advection Equation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#numerical-techniques">Numerical Techniques</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#forward-time-central-space-ftcs-method">Forward-Time Central-Space (FTCS) Method</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#stability-and-accuracy">Stability And Accuracy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#upwind-and-downwind-methods">Upwind and Downwind Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Stability And Accuracy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-code-matrix-form">Python Code (Matrix form)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#matlab-code-matrix-form">Matlab Code (Matrix form)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#julia-code-matrix-form">Julia Code (Matrix form)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modified-equation">Modified Equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#error-due-to-diffusion-and-dispersion">Error due to Diffusion and Dispersion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#method-of-lines">Method of lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-code-using-mol">Python Code (Using MOL)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#matlab-code-using-mol">Matlab Code (Using MOL)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#julia-code-using-mol">Julia Code (Using MOL)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lax-wendroff-method">Lax-Wendroff Method</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Stability And Accuracy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-code-using-matrix-form">Python Code (Using Matrix form)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#matlab-code-using-matrix-form">Matlab Code (Using Matrix form)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#julia-code-using-matrix-form">Julia Code (Using Matrix form)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Modified Equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Error due to Diffusion and Dispersion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">licence</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Diff. Academy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Linear 1D Advection Equation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/linear_1d_advection_equation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="linear-1d-advection-equation">
<h1>Linear 1D Advection Equation<a class="headerlink" href="#linear-1d-advection-equation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>1D linear advection equation (so called wave equation) is one of the
simplest equations in mathematics. The equation is described as:</p>
<div class="math notranslate nohighlight" id="equation-adv-1d">
<span class="eqno">(1)<a class="headerlink" href="#equation-adv-1d" title="Permalink to this equation">¶</a></span>\[\frac{\partial u}{\partial t} + c \frac{\partial u}{\partial x} = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(u(x,t), x \in \mathbb{R}\)</span> is a scalar (wave), advected by a nonezero constant <span class="math notranslate nohighlight">\(c\)</span> during time <span class="math notranslate nohighlight">\(t\)</span>. The sign of <span class="math notranslate nohighlight">\(c\)</span>
characterise the direction of wave propagation. If <span class="math notranslate nohighlight">\(c&gt;0\)</span>, the wave propagates in the positive direction of <span class="math notranslate nohighlight">\(x\)</span>-axis. On the other hand if <span class="math notranslate nohighlight">\(c&lt;0\)</span> then
the wave propagates to the negative direction of <cite>x</cite>-axis. The mangitude of <span class="math notranslate nohighlight">\(c\)</span> tells us how fast the wave propagates.
The exact solution of this equation is given by its initial value. Assuming that the initial value for equation
<a class="reference internal" href="#equation-adv-1d">(1)</a> is given as <span class="math notranslate nohighlight">\(u_0(x) = u(x,0)\)</span>, the exact solution of equation <a class="reference internal" href="#equation-adv-1d">(1)</a> is:</p>
<div class="math notranslate nohighlight" id="equation-ex-adv-1d">
<span class="eqno">(2)<a class="headerlink" href="#equation-ex-adv-1d" title="Permalink to this equation">¶</a></span>\[u(x,t) = u_{0}(x-ct)\]</div>
</div>
<div class="section" id="numerical-techniques">
<h2>Numerical Techniques<a class="headerlink" href="#numerical-techniques" title="Permalink to this headline">¶</a></h2>
<p>Although this equation is simple to solve, it can be very useful for learning numerical techniques. We start by introducing the
numerical methods.</p>
<div class="section" id="forward-time-central-space-ftcs-method">
<h3>Forward-Time Central-Space (FTCS) Method<a class="headerlink" href="#forward-time-central-space-ftcs-method" title="Permalink to this headline">¶</a></h3>
<p>FTCS is based on central spatial difference scheme and the temporal forward Euler method.  Assume that <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(x\)</span> are
descritized uniformly as:</p>
<div class="math notranslate nohighlight" id="equation-ti">
<span class="eqno">(3)<a class="headerlink" href="#equation-ti" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}t_{n}= t_{0}+ \Delta t   \qquad n=0,...,T\\x_{i}= x_{0}+ \Delta x   \qquad i=0,...,N\end{aligned}\end{align} \]</div>
<p>Let us assume that <span class="math notranslate nohighlight">\(u_{i}^{n}:=u(x_i,t_n)\)</span>. Then using applying central spatial difference and the temporal forward Euler methods to
equation <a class="reference internal" href="#equation-adv-1d">(1)</a>, we have:</p>
<div class="math notranslate nohighlight" id="equation-adv-1d-dis1">
<span class="eqno">(4)<a class="headerlink" href="#equation-adv-1d-dis1" title="Permalink to this equation">¶</a></span>\[\frac{u_{i}^{n+1}-u_{i}^{n}}{\Delta t} + c \frac{u_{i-1}^{n}-u_{i+1}^{n}}{2 \Delta x}  = 0\]</div>
<p>If we rearrange equation <a class="reference internal" href="#equation-adv-1d-dis1">(4)</a> we finally have:</p>
<div class="math notranslate nohighlight" id="equation-adv-1d-dis">
<span class="eqno">(5)<a class="headerlink" href="#equation-adv-1d-dis" title="Permalink to this equation">¶</a></span>\[u_{i}^{n+1}=u_{i}^{n}+ c \frac{ \Delta t}{2 \Delta x} \Big(u_{i-1}^{n}-u_{i+1}^{n}\Big)\]</div>
<div class="section" id="stability-and-accuracy">
<h4>Stability And Accuracy<a class="headerlink" href="#stability-and-accuracy" title="Permalink to this headline">¶</a></h4>
<p>Let assume that solution of equation <a class="reference internal" href="#equation-adv-1d">(1)</a> is periodic in the defined domain. Lets consider <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> is the solution of
equation <a class="reference internal" href="#equation-adv-1d">(1)</a>. Since this equation is a linear PDE, solution of this PDE is a sum of Fourier modes:</p>
<div class="math notranslate nohighlight" id="equation-for-mod">
<span class="eqno">(6)<a class="headerlink" href="#equation-for-mod" title="Permalink to this equation">¶</a></span>\[\psi(x,t) = \sum_{k=-\infty}^{\infty} a_k e^{ikx}\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is the wave number. Now let us study the stability of solution considering an individual wave number. Let us discretize
our space and time domain to <span class="math notranslate nohighlight">\(x_{j}=j\Delta x\)</span> and <span class="math notranslate nohighlight">\(t_{n}=n\Delta t\)</span>, for <span class="math notranslate nohighlight">\((j,n=0,1,...)\)</span>, then the solution at <span class="math notranslate nohighlight">\(x_j\)</span> at
time <span class="math notranslate nohighlight">\(t_n\)</span> is <span class="math notranslate nohighlight">\(\psi(x_j,t_n)\)</span>. We can see how the solution is amplified (or damped) by considering analytical
amplification factor <span class="math notranslate nohighlight">\(A_a\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-a-a">
<span class="eqno">(7)<a class="headerlink" href="#equation-a-a" title="Permalink to this equation">¶</a></span>\[\psi(x,t_{n+1})= A_a \psi(x,t_{n})\]</div>
<p>Using this and discretization of the spatial domain and considering the solution of one wave number, we have</p>
<div class="math notranslate nohighlight" id="equation-wave">
<span class="eqno">(8)<a class="headerlink" href="#equation-wave" title="Permalink to this equation">¶</a></span>\[\psi_{j}^{n}=\psi(x_j,t_n) = A_a^n e^{ik x_j} = A_a^n e^{i \Delta x}\]</div>
<p>Using the same idea for numerical scheme, we can also consider numerical amplification factor <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-wave-n">
<span class="eqno">(9)<a class="headerlink" href="#equation-wave-n" title="Permalink to this equation">¶</a></span>\[\Psi_{j}^{n}=\Psi(x_j,t_n) = A^n e^{ik x_j} = A^n e^{i \Delta x}\]</div>
<p>where here <span class="math notranslate nohighlight">\(\Psi\)</span> is our aproximated solution using a linear numerical scheme. Now we can use this equation in our numerical scheme and analyse its stability. Using equation <a class="reference internal" href="#equation-wave">(8)</a> in equation <a class="reference internal" href="#equation-adv-1d-dis">(5)</a> we have</p>
<div class="math notranslate nohighlight" id="equation-ftcs-a">
<span class="eqno">(10)<a class="headerlink" href="#equation-ftcs-a" title="Permalink to this equation">¶</a></span>\[A= 1 - i \frac{ \Delta t}{ \Delta x} sin(k \Delta x)\]</div>
<p>In order that our numerical method to be stable, <span class="math notranslate nohighlight">\(|A|\)</span> should be less than 1. Calculating <span class="math notranslate nohighlight">\(|A|\)</span> we have</p>
<div class="math notranslate nohighlight" id="equation-ftcs-a2">
<span class="eqno">(11)<a class="headerlink" href="#equation-ftcs-a2" title="Permalink to this equation">¶</a></span>\[|A|^2 = 1 + ( \frac{ \Delta t}{ \Delta x} sin(k \Delta x) )^2\]</div>
<p>The above equation can never be able to be less that or equal to 1. Practically this method is not usefull since using von Neumann Stability Analysis,
FTCS method is unconditionally unstable.</p>
</div>
</div>
<div class="section" id="upwind-and-downwind-methods">
<h3>Upwind and Downwind Methods<a class="headerlink" href="#upwind-and-downwind-methods" title="Permalink to this headline">¶</a></h3>
<p>Upwind and downwind methods refer to those methods that the spatial differences are skewed in the flow direction. The simplest upwind and downwind methods are the discribed by
backward (<span class="math notranslate nohighlight">\(c &gt; 0\)</span>) or forward (<span class="math notranslate nohighlight">\(c &lt; 0\)</span>) spatial difference and the temporal forward Euler methods, respectively. As it is mentioned, the choice between the two spatial methods are dictated by the
sign of <span class="math notranslate nohighlight">\(c\)</span>, meaning the flow direction. Using the descritization methods described above we get:</p>
<div class="math notranslate nohighlight" id="equation-adv-1d-upwind1">
<span class="eqno">(12)<a class="headerlink" href="#equation-adv-1d-upwind1" title="Permalink to this equation">¶</a></span>\[\frac{u_{i}^{n+1}-u_{i}^{n}}{\Delta t} + \gamma_{min} \Big(\frac{u_{i+1}^{n}-u_{i}^{n}}{ \Delta x} \Big)+ \gamma_{max} \Big(\frac{u_{i}^{n}-u_{i-1}^{n}}{ \Delta x} \Big) = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma_{min}:=min(a,0)\)</span> and <span class="math notranslate nohighlight">\(\gamma_{max}:=max(a,0)\)</span>. Rearranging equation <a class="reference internal" href="#equation-adv-1d-upwind1">(12)</a> we have:</p>
<div class="math notranslate nohighlight" id="equation-adv-1d-upwind">
<span class="eqno">(13)<a class="headerlink" href="#equation-adv-1d-upwind" title="Permalink to this equation">¶</a></span>\[u_{i}^{n+1}= \alpha_{max} u_{i-1}^{n}+(1+\alpha_{min}-\alpha_{max})u_{i}^{n} -\alpha_{min}u_{i+1}^{n}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_{min}:=\frac{\gamma_{min} \Delta t}{\Delta x}\)</span> and <span class="math notranslate nohighlight">\(\alpha_{max}:=\frac{\gamma_{max} \Delta t}{\Delta x}\)</span>. Considering the solution is periodic, we can rewrite equation  <a class="reference internal" href="#equation-adv-1d-upwind">(13)</a>
in its matrix form:</p>
<div class="math notranslate nohighlight" id="equation-mat-eq">
<span class="eqno">(14)<a class="headerlink" href="#equation-mat-eq" title="Permalink to this equation">¶</a></span>\[\mathbf{U}^{n+1}= \mathbf{A}^{n+1}\mathbf{U}^{n}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{U}^{n+1}=[u_{0}^{n+1},u_{1}^{n+1},...,u_{N-1}^{n+1},u_{N}^{n+1}]^{T}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}^{n}=[u_{0}^{n},u_{1}^{n},...,u_{N-1}^{n},u_{N}^{n}]^{T}\)</span> and
matrix  <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> for equation <a class="reference internal" href="#equation-adv-1d-upwind">(13)</a> is:</p>
<div class="math notranslate nohighlight" id="equation-matrixa">
<span class="eqno">(15)<a class="headerlink" href="#equation-matrixa" title="Permalink to this equation">¶</a></span>\[\begin{split} \small\mathbf{A}=\small\begin{bmatrix}
 (1+\alpha_{min}-\alpha_{max}) &amp; -\alpha_{min} &amp; 0 &amp; 0 &amp; 0&amp; ... &amp; \alpha_{max} \\
 \alpha_{max} &amp; (1+\alpha_{min}-\alpha_{max}) &amp; -\alpha_{min}&amp; 0 &amp; 0 &amp;... &amp; 0 \\
 0 &amp; \alpha_{max} &amp; (1+\alpha_{min}-\alpha_{max}) &amp; -\alpha_{min}&amp; 0 &amp;... &amp; 0 \\
  \vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp;  \ddots &amp; \vdots &amp; \vdots \\
 0 &amp;0 &amp;... &amp; \alpha_{max} &amp; (1+\alpha_{min}-\alpha_{max}) &amp;  -\alpha_{min} &amp; 0 \\
 0 &amp;0 &amp;... &amp; 0 &amp; \alpha_{max} &amp; (1+\alpha_{min}-\alpha_{max}) &amp;  -\alpha_{min}  \\
 -\alpha_{min} &amp;0 &amp;... &amp; 0 &amp; 0&amp;  \alpha_{max} &amp; (1+\alpha_{min}-\alpha_{max})  \\
 \end{bmatrix}_{N\times N }\end{split}\]</div>
<p>As we mentioned above, if (<span class="math notranslate nohighlight">\(c &gt; 0\)</span>) we refer the discretization methods above as upwind and  if (<span class="math notranslate nohighlight">\(c &lt; 0\)</span>) as downwind.</p>
<div class="section" id="id1">
<h4>Stability And Accuracy<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Using the same idea from previous section, we calculate the <span class="math notranslate nohighlight">\(A\)</span> for upwind method:</p>
<div class="math notranslate nohighlight" id="equation-upwind-aup">
<span class="eqno">(16)<a class="headerlink" href="#equation-upwind-aup" title="Permalink to this equation">¶</a></span>\[A = (1-C)+C e^{-i k \Delta x}\]</div>
<p>where <span class="math notranslate nohighlight">\(C=\frac{c \Delta t}{\Delta x}\)</span>. Now calculating its norm, we have:</p>
<div class="math notranslate nohighlight" id="equation-upwind-a">
<span class="eqno">(17)<a class="headerlink" href="#equation-upwind-a" title="Permalink to this equation">¶</a></span>\[|A|^2 = 1 - 2 C (1-C)(1-cos(k \Delta x))\]</div>
<p>If this method is stable, then <span class="math notranslate nohighlight">\(|A| \leq 1\)</span>. Then we have,</p>
<div class="math notranslate nohighlight" id="equation-upwind-a2">
<span class="eqno">(18)<a class="headerlink" href="#equation-upwind-a2" title="Permalink to this equation">¶</a></span>\[1 - 2 C (1-C)(1-cos(k \Delta x)) \leq 1  \to 0 \le C (1-C)(sin^2 (k \Delta x / 2))\]</div>
<p>which leads to</p>
<div class="math notranslate nohighlight" id="equation-cfl-cond">
<span class="eqno">(19)<a class="headerlink" href="#equation-cfl-cond" title="Permalink to this equation">¶</a></span>\[C= \frac{c \Delta t}{\Delta x} \leq 1\]</div>
<p>Thus this method is conditionally stable. Using the same analogy, for the downwind method we have</p>
<div class="math notranslate nohighlight" id="equation-dwind-a">
<span class="eqno">(20)<a class="headerlink" href="#equation-dwind-a" title="Permalink to this equation">¶</a></span>\[|A|^2 = 1 - 2 C (1+C)(1-cos(k \Delta x))\]</div>
<p>and if the method is stable, then <span class="math notranslate nohighlight">\(|A| \leq 1\)</span> leading to</p>
<div class="math notranslate nohighlight" id="equation-cfl-cond-dw">
<span class="eqno">(21)<a class="headerlink" href="#equation-cfl-cond-dw" title="Permalink to this equation">¶</a></span>\[C= \frac{c \Delta t}{\Delta x} \geq -1\]</div>
</div>
<div class="section" id="python-code-matrix-form">
<h4>Python Code (Matrix form)<a class="headerlink" href="#python-code-matrix-form" title="Permalink to this headline">¶</a></h4>
<p>Here is a python code for modeling the 1D linear advection equation using upwind method described above.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>    
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="k">class</span> <span class="nc">LinearAdvection1D</span><span class="p">:</span>
    <span class="c1"># Matrix for LA1D </span>
   <span class="n">A</span><span class="o">=</span><span class="mi">0</span>
   <span class="c1"># Initialization of constants </span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">xN</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">deltaT</span><span class="p">,</span><span class="n">T</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span> 
      <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span>   
      <span class="bp">self</span><span class="o">.</span><span class="n">xN</span> <span class="o">=</span> <span class="n">xN</span> 
      <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>   
      <span class="bp">self</span><span class="o">.</span><span class="n">deltaT</span> <span class="o">=</span> <span class="n">deltaT</span>   
      <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>       
   <span class="c1"># CFL number funct.   </span>
   <span class="k">def</span> <span class="nf">CFL</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="n">deltaX</span><span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xN</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span>
       <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">deltaT</span><span class="o">/</span><span class="n">deltaX</span><span class="p">)</span>
   <span class="c1"># check CFL number &lt;=1 or not.</span>
   <span class="k">def</span> <span class="nf">checkCFL</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">()</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">):</span>
           <span class="n">flag</span><span class="o">=</span><span class="bp">True</span> 
       <span class="k">else</span><span class="p">:</span>
           <span class="n">flag</span><span class="o">=</span><span class="bp">False</span>
       <span class="k">return</span> <span class="n">flag</span>
   <span class="c1"># Matrix assembly of LA1D   </span>
   <span class="k">def</span> <span class="nf">upwindMatrixAssembly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="n">alpha_min</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
       <span class="n">alpha_max</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
       <span class="n">a1</span><span class="o">=</span><span class="p">[</span><span class="n">alpha_max</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">a2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha_min</span><span class="o">-</span><span class="n">alpha_max</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
       <span class="n">a3</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">alpha_min</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">alpha_max</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=-</span><span class="n">alpha_min</span>
   <span class="c1"># Solve u=Au0</span>
   <span class="k">def</span> <span class="nf">Solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">u0</span><span class="p">):</span>
       <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">u0</span><span class="p">)</span> 

<span class="c1">#############  </span>
<span class="c1"># Start of the code</span>
<span class="c1">###################</span>

<span class="c1"># constants  </span>
<span class="n">N</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">deltaT</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.5</span>
<span class="c1"># initialization of constants</span>
<span class="n">LA1D</span> <span class="o">=</span> <span class="n">LinearAdvection1D</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">xN</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">deltaT</span><span class="p">,</span><span class="n">T</span><span class="p">)</span> 

<span class="c1"># initial value</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">LA1D</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span><span class="n">LA1D</span><span class="o">.</span><span class="n">xN</span><span class="p">,</span><span class="n">LA1D</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="n">u0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>

<span class="c1">#plot of initial value    </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Initial value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="c1"># calculating solution if CFL&lt;=1</span>
<span class="k">if</span> <span class="p">(</span><span class="n">LA1D</span><span class="o">.</span><span class="n">checkCFL</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;CFL number is: &quot;</span><span class="p">,</span> <span class="n">LA1D</span><span class="o">.</span><span class="n">CFL</span><span class="p">())</span>
    <span class="n">LA1D</span><span class="o">.</span><span class="n">upwindMatrixAssembly</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">LA1D</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">LA1D</span><span class="o">.</span><span class="n">deltaT</span><span class="p">)):</span>
        <span class="n">u</span><span class="o">=</span><span class="n">LA1D</span><span class="o">.</span><span class="n">Solve</span><span class="p">(</span><span class="n">u0</span><span class="p">)</span>
        <span class="n">u0</span><span class="o">=</span><span class="n">u</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;CFL number is greater than 1. CFL: &quot;</span><span class="p">,</span> <span class="n">LA1D</span><span class="o">.</span><span class="n">CFL</span><span class="p">())</span>

<span class="c1"># ploting the last solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Solution at t=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">LA1D</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;LA1D.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">deltaT</span><span class="o">/</span><span class="p">((</span><span class="n">xN</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">LA1D</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
 
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/LA1D_Python.png"><img alt="alternate text" class="align-center" src="_images/LA1D_Python.png" style="width: 500px; height: 400px;" /></a>
<p>For the explanaition of the code, please take a look at the youtube video.</p>
</div>
<div class="section" id="matlab-code-matrix-form">
<h4>Matlab Code (Matrix form)<a class="headerlink" href="#matlab-code-matrix-form" title="Permalink to this headline">¶</a></h4>
<p>Here is a Matlab code for modeling the 1D linear advection equation using upwind method described above. First we define a class called LinearAdvection1D:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">classdef</span> <span class="n">LinearAdvection1D</span> <span class="o">&lt;</span> <span class="n">handle</span>    
    <span class="k">properties</span>
        <span class="c">%  constants</span>
        <span class="n">A</span><span class="p">;</span><span class="n">N</span><span class="p">;</span><span class="n">x0</span><span class="p">;</span><span class="n">xN</span><span class="p">;</span><span class="n">deltaT</span><span class="p">;</span><span class="n">c</span><span class="p">;</span><span class="n">T</span><span class="p">;</span>
    <span class="k">end</span>
    
    <span class="k">methods</span>
        <span class="c">% Initialization of constants</span>
<span class="k">        function</span><span class="w"> </span>self <span class="p">=</span><span class="w"> </span><span class="nf">LinearAdvection1D</span><span class="p">(</span>N,x0,xN,deltaT,c,T<span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">N</span> <span class="p">=</span> <span class="n">N</span><span class="p">;</span> <span class="n">self</span><span class="p">.</span><span class="n">x0</span> <span class="p">=</span> <span class="n">x0</span><span class="p">;</span> <span class="n">self</span><span class="p">.</span><span class="n">xN</span> <span class="p">=</span> <span class="n">xN</span><span class="p">;</span> 
            <span class="n">self</span><span class="p">.</span><span class="n">deltaT</span> <span class="p">=</span> <span class="n">deltaT</span><span class="p">;</span>
            <span class="n">self</span><span class="p">.</span><span class="n">c</span> <span class="p">=</span> <span class="n">c</span><span class="p">;</span> <span class="n">self</span><span class="p">.</span><span class="n">T</span> <span class="p">=</span> <span class="n">T</span><span class="p">;</span><span class="n">self</span><span class="p">.</span><span class="n">A</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="c">% CFL number funct.</span>
<span class="k">        function</span><span class="w"> </span>outputArg <span class="p">=</span><span class="w"> </span><span class="nf">CFL</span><span class="p">(</span>self<span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="n">deltaX</span><span class="p">=</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">xN</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">self</span><span class="p">.</span><span class="n">N</span> <span class="p">;</span>
           <span class="n">outputArg</span> <span class="p">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">c</span><span class="o">*</span><span class="n">self</span><span class="p">.</span><span class="n">deltaT</span><span class="o">/</span><span class="n">deltaX</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="c">% check CFL number &lt;=1 or not.</span>
<span class="k">        function</span><span class="w"> </span>flag<span class="p">=</span><span class="nf">checkCFL</span><span class="p">(</span>self<span class="p">)</span><span class="w"></span>
<span class="w">           </span><span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">CFL</span><span class="p">()</span><span class="o">&lt;</span><span class="p">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">flag</span><span class="p">=</span><span class="n">true</span><span class="p">;</span>
           <span class="k">else</span>
                <span class="n">flag</span><span class="p">=</span><span class="n">false</span><span class="p">;</span>
           <span class="k">end</span> 
        <span class="k">end</span>
        <span class="c">% Matrix assembly of LA1D</span>
<span class="k">        function</span><span class="w"> </span><span class="nf">upwindMatrixAssembly</span><span class="p">(</span>self<span class="p">)</span><span class="w"></span>
<span class="w">           </span><span class="n">alpha_min</span><span class="p">=</span><span class="n">min</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">CFL</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
           <span class="n">alpha_max</span><span class="p">=</span><span class="n">max</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">CFL</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
           <span class="n">a1</span><span class="p">=</span><span class="n">alpha_max</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
           <span class="n">a2</span><span class="p">=(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha_min</span><span class="o">-</span><span class="n">alpha_max</span><span class="p">)</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">N</span><span class="p">);</span>
           <span class="n">a3</span><span class="p">=</span><span class="o">-</span><span class="n">alpha_min</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
           <span class="n">self</span><span class="p">.</span><span class="n">A</span><span class="p">=</span><span class="nb">diag</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">diag</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="nb">diag</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
           <span class="n">self</span><span class="p">.</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="k">end</span><span class="p">)=</span><span class="n">alpha_max</span><span class="p">;</span>
           <span class="n">self</span><span class="p">.</span><span class="n">A</span><span class="p">(</span><span class="k">end</span><span class="p">,</span><span class="mi">1</span><span class="p">)=</span><span class="o">-</span><span class="n">alpha_min</span><span class="p">;</span>
        <span class="k">end</span>
        <span class="c">% Upwind solve</span>
<span class="k">        function</span><span class="w"> </span>x <span class="p">=</span><span class="w"> </span><span class="nf">Solve</span><span class="p">(</span>self,u0<span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">x</span><span class="p">=</span><span class="n">transpose</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">A</span><span class="o">*</span><span class="n">transpose</span><span class="p">(</span><span class="n">u0</span><span class="p">));</span>
        <span class="k">end</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For the main code we use LinearAdvection1D class in the folloing m file.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">clc</span>
<span class="n">clear</span> <span class="n">all</span>

<span class="c">% constants</span>
<span class="n">N</span><span class="p">=</span><span class="mi">100</span><span class="p">;</span><span class="n">x0</span><span class="p">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">xN</span><span class="p">=</span><span class="mf">10.</span><span class="p">;</span><span class="n">deltaT</span><span class="p">=</span><span class="mf">0.05</span><span class="p">;</span><span class="n">c</span><span class="p">=</span><span class="mf">1.</span><span class="p">;</span><span class="n">T</span><span class="p">=</span><span class="mf">0.5</span><span class="p">;</span>
<span class="c">% object LA1D initialization</span>
<span class="n">LA1D</span><span class="p">=</span><span class="n">LinearAdvection1D</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">deltaT</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>

<span class="n">x</span><span class="p">=</span><span class="nb">linspace</span><span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">x0</span><span class="p">,</span><span class="n">LA1D</span><span class="p">.</span><span class="n">xN</span><span class="p">,</span><span class="n">LA1D</span><span class="p">.</span><span class="n">N</span><span class="p">);</span>
<span class="c">% initial value</span>
<span class="n">u0</span><span class="p">=</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>

<span class="c">% plot of initial value</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u0</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span>&quot;<span class="n">x</span>&quot;<span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span>&quot;<span class="n">u</span>&quot;<span class="p">)</span>

<span class="c">% calculating solution if CFL&lt;=1</span>
<span class="k">if</span> <span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">checkCFL</span><span class="p">()</span><span class="o">==</span> <span class="n">true</span><span class="p">)</span>
    <span class="nb">disp</span><span class="p">(</span><span class="n">strcat</span><span class="p">(</span>&quot;<span class="n">CFL</span> <span class="n">number</span> <span class="n">is</span><span class="p">:</span> &quot;<span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">CFL</span><span class="p">())))</span>
    <span class="n">LA1D</span><span class="p">.</span><span class="n">upwindMatrixAssembly</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">t</span><span class="p">=</span><span class="mi">0</span><span class="p">:</span><span class="n">uint8</span><span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">T</span><span class="o">/</span><span class="n">LA1D</span><span class="p">.</span><span class="n">deltaT</span><span class="p">)</span>
        <span class="n">u</span><span class="p">=</span><span class="n">LA1D</span><span class="p">.</span><span class="n">upwindSolve</span><span class="p">(</span><span class="n">u0</span><span class="p">);</span>
        <span class="n">u0</span><span class="p">=</span><span class="n">u</span><span class="p">;</span>
    <span class="k">end</span>
<span class="k">else</span>
    <span class="nb">disp</span><span class="p">(</span><span class="n">strcat</span><span class="p">(</span>&quot;<span class="n">CFL</span> <span class="n">number</span> <span class="n">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">1.</span> <span class="n">CFL</span><span class="p">:</span> &quot;<span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">CFL</span><span class="p">())))</span>
<span class="k">end</span>

<span class="c">% ploting the last solution</span>
<span class="n">hold</span> <span class="n">on</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
<span class="n">legend</span><span class="p">({</span>&quot;<span class="n">Initial</span> <span class="n">value</span>&quot;<span class="p">,</span><span class="n">strcat</span><span class="p">(</span>&quot;<span class="n">Solution</span> <span class="n">at</span> <span class="n">t</span><span class="p">=</span>&quot;<span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">T</span><span class="p">))},</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;east&#39;</span><span class="p">)</span>
<span class="n">axis</span><span class="p">([</span><span class="mi">0</span> <span class="mf">10.1</span>  <span class="mi">0</span> <span class="mf">1.1</span><span class="p">])</span> 
<span class="n">grid</span> <span class="n">on</span>
</pre></div>
</div>
<p>For the explanaition of the code, please take a look at the youtube video.</p>
<a class="reference internal image-reference" href="_images/LA1D_Matlab.png"><img alt="alternate text" class="align-center" src="_images/LA1D_Matlab.png" style="width: 500px; height: 400px;" /></a>
</div>
<div class="section" id="julia-code-matrix-form">
<h4>Julia Code (Matrix form)<a class="headerlink" href="#julia-code-matrix-form" title="Permalink to this headline">¶</a></h4>
<p>Here is a Julia code for modeling the 1D linear advection equation using upwind method described above.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">PyPlot</span>
<span class="k">type</span> <span class="n">LinearAdvection1d</span>
    <span class="c"># dataIn  [c,x0,xN,deltaT,T]</span>
    <span class="n">dataIn</span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span>     
    <span class="n">N</span><span class="o">::</span><span class="kt">Int</span>    
    
    <span class="n">Initialize</span><span class="o">::</span><span class="kt">Function</span>
    <span class="n">CFL</span><span class="o">::</span><span class="kt">Function</span>
    <span class="n">checkCFL</span><span class="o">::</span><span class="kt">Function</span>
    <span class="n">upwindMatrixAssembly</span><span class="o">::</span><span class="kt">Function</span>
    <span class="n">upwindSolve</span><span class="o">::</span><span class="kt">Function</span>
    
    <span class="k">function</span> <span class="n">LinearAdvection1d</span><span class="p">()</span>
        <span class="n">self</span> <span class="o">=</span> <span class="n">new</span><span class="p">()</span>
        
        <span class="n">self</span><span class="o">.</span><span class="n">Initialize</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="n">dataIn</span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span> <span class="n">N</span><span class="o">::</span><span class="kt">Int</span><span class="p">)</span>
            <span class="n">self</span><span class="o">.</span><span class="n">dataIn</span> <span class="o">=</span> <span class="n">dataIn</span>
            <span class="n">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
        <span class="k">end</span>
        <span class="n">self</span><span class="o">.</span><span class="n">CFL</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> 
            <span class="n">deltaX</span><span class="o">=</span> <span class="p">(</span><span class="n">self</span><span class="o">.</span><span class="n">dataIn</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">self</span><span class="o">.</span><span class="n">dataIn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">self</span><span class="o">.</span><span class="n">N</span>
            <span class="k">return</span> <span class="n">abs</span><span class="p">(</span><span class="n">self</span><span class="o">.</span><span class="n">dataIn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">self</span><span class="o">.</span><span class="n">dataIn</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="n">deltaX</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="n">self</span><span class="o">.</span><span class="n">checkCFL</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span>
            <span class="k">return</span>  <span class="n">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">()</span><span class="o">&lt;=</span><span class="mi">1</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span>
        <span class="k">end</span>

        <span class="n">self</span><span class="o">.</span><span class="n">upwindMatrixAssembly</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span> 
            <span class="n">alpha_min</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">alpha_max</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">a1</span><span class="o">=</span><span class="p">[</span><span class="n">alpha_max</span> <span class="k">for</span> <span class="n">n</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">a2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha_min</span><span class="o">-</span><span class="n">alpha_max</span> <span class="k">for</span> <span class="n">n</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="p">]</span>
            <span class="n">a3</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">alpha_min</span> <span class="k">for</span> <span class="n">n</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">A</span><span class="o">=</span><span class="kt">Tridiagonal</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">)</span><span class="o">+</span><span class="n">zeros</span><span class="p">(</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
            <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="k">end</span><span class="p">]</span><span class="o">=</span><span class="n">alpha_max</span>
            <span class="n">A</span><span class="p">[</span><span class="k">end</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="n">alpha_min</span>
            <span class="k">return</span> <span class="n">A</span>
        <span class="k">end</span>
        
        <span class="n">self</span><span class="o">.</span><span class="n">upwindSolve</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">u0</span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">})</span>
             <span class="k">return</span> <span class="n">self</span><span class="o">.</span><span class="n">upwindMatrixAssembly</span><span class="p">()</span><span class="o">*</span><span class="n">u0</span>
        <span class="k">end</span>        
    <span class="k">end</span> 
<span class="k">end</span>

<span class="c">#####################</span>
<span class="c"># Start of the code</span>
<span class="c">#####################</span>

<span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">xN</span><span class="o">=</span><span class="mf">10.</span><span class="p">;</span><span class="n">deltaT</span><span class="o">=</span><span class="mf">0.05</span><span class="p">;</span><span class="n">c</span><span class="o">=</span><span class="mf">1.</span><span class="p">;</span><span class="n">T</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span>
<span class="n">LA1D</span><span class="o">=</span><span class="n">LinearAdvection1d</span><span class="p">()</span>
<span class="n">LA1D</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="n">Initialize</span><span class="p">([</span><span class="n">c</span><span class="p">;</span><span class="n">x0</span><span class="p">;</span><span class="n">xN</span><span class="p">;</span><span class="n">deltaT</span><span class="p">;</span><span class="n">T</span><span class="p">],</span><span class="n">N</span><span class="p">)</span>
<span class="n">LA1D</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="n">checkCFL</span><span class="p">()</span>


<span class="n">x</span><span class="o">=</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">u0</span> <span class="o">=</span> <span class="p">[</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mf">2.</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span> <span class="kp">in</span> <span class="n">x</span><span class="p">];</span>



<span class="n">PyPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Initial value&quot;</span><span class="p">)</span>     
        
<span class="k">if</span> <span class="n">LA1D</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="n">checkCFL</span><span class="p">()</span>
    <span class="n">println</span><span class="p">(</span><span class="s">&quot;CFL number is: &quot;</span><span class="p">,</span> <span class="n">LA1D</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span> <span class="o">:</span> <span class="n">floor</span><span class="p">(</span><span class="kt">Integer</span><span class="p">,</span><span class="n">T</span><span class="o">/</span><span class="n">deltaT</span><span class="p">)</span>
        <span class="n">u</span><span class="o">=</span><span class="n">LA1D</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="n">upwindSolve</span><span class="p">(</span><span class="n">u0</span><span class="p">)</span>
        <span class="n">u0</span><span class="o">=</span><span class="n">u</span>
    <span class="k">end</span>
<span class="k">else</span>
    <span class="n">println</span><span class="p">(</span><span class="s">&quot;CFL number is greater than 1. CFL: &quot;</span><span class="p">,</span> <span class="n">LA1D</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">())</span>    
<span class="k">end</span>

<span class="n">PyPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;Solution at t=&quot;</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
<span class="n">PyPlot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">PyPlot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;dotted&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For the explanaition of the code, please take a look at the youtube video.</p>
<a class="reference internal image-reference" href="_images/LA1D_Julia.png"><img alt="alternate text" class="align-center" src="_images/LA1D_Julia.png" style="width: 500px; height: 400px;" /></a>
</div>
<div class="section" id="modified-equation">
<h4>Modified Equation<a class="headerlink" href="#modified-equation" title="Permalink to this headline">¶</a></h4>
<p>Modified equation first was introduced by Warming et al. which is a powerful tool of analysis the truncation error of time-dependent linear PDEs.
In particular, the effect of diffusion or dispersion of the error terms can be studied using modified equation. Considering equation <a class="reference internal" href="#equation-adv-1d-upwind">(13)</a>, the
modified equation refers to the following formal equation:</p>
<div class="math notranslate nohighlight" id="equation-modif-upwind">
<span class="eqno">(22)<a class="headerlink" href="#equation-modif-upwind" title="Permalink to this equation">¶</a></span>\[v(x,t+\Delta t) = \alpha_{max} v(x-\Delta x,t) + (1+\alpha_{min}-\alpha_{max}) v(x,t) - \alpha_{min} v(x+\Delta x,t)\]</div>
<p>Assuming <span class="math notranslate nohighlight">\(v\)</span> is <span class="math notranslate nohighlight">\(C^{\infty}\)</span>, one can use taylor expansion of all terms in the above equation and deduce the folloing:</p>
<div class="math notranslate nohighlight" id="equation-modif-upwind1">
<span class="eqno">(23)<a class="headerlink" href="#equation-modif-upwind1" title="Permalink to this equation">¶</a></span>\[v_{t} +\Delta t v_{tt} +O(\Delta t^2)= -(\gamma_{max}+\gamma_{min}) v_x + \frac{\Delta x}{2}(\gamma_{max}-\gamma_{min}) v_{xx} - \frac{\Delta^{2} x}{6}(\gamma_{max}+\gamma_{min}) v_{xxx} +O(\Delta x^3)\]</div>
<p>using <span class="math notranslate nohighlight">\(\gamma_{max}+\gamma_{min}= c\)</span> and <span class="math notranslate nohighlight">\(\gamma_{max}-\gamma_{min}= sign(c)c=|c|\)</span> we have:</p>
<div class="math notranslate nohighlight" id="equation-modif-upwind2">
<span class="eqno">(24)<a class="headerlink" href="#equation-modif-upwind2" title="Permalink to this equation">¶</a></span>\[v_{t}+ c v_x  =-\Delta t v_{tt} + \Big(\frac{\Delta x}{2} |c|\Big)v_{xx} - \Big(\frac{\Delta^{2} x}{6}c\Big) v_{xxx} +O(\Delta^2 t,\Delta^3 x)\]</div>
<p>taking the partial derivative of equation <a class="reference internal" href="#equation-modif-upwind2">(24)</a> with respect <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(x\)</span> we have:</p>
<div class="math notranslate nohighlight" id="equation-modif-upwind3">
<span class="eqno">(25)<a class="headerlink" href="#equation-modif-upwind3" title="Permalink to this equation">¶</a></span>\[v_{tt}+ c v_{xt}  =-\Delta t v_{ttt} + \Big(\frac{\Delta x}{2} |c|\Big)v_{xxt} - \Big(\frac{\Delta^{2} x}{6}c\Big) v_{xxxt} +O(\Delta^2 t,\Delta^3 x)\]</div>
<div class="math notranslate nohighlight" id="equation-modif-upwind4">
<span class="eqno">(26)<a class="headerlink" href="#equation-modif-upwind4" title="Permalink to this equation">¶</a></span>\[v_{tx}+ c v_{xx}  =-\Delta t v_{ttx} + \Big(\frac{\Delta x}{2} |c|\Big)v_{xxx} - \Big(\frac{\Delta^{2} x}{6}c\Big) v_{xxxx} +O(\Delta^2 t,\Delta^3 x)\]</div>
<p>If we multiply equation <a class="reference internal" href="#equation-modif-upwind4">(26)</a>  by <span class="math notranslate nohighlight">\(-c\)</span> and sum it with equation <a class="reference internal" href="#equation-modif-upwind3">(25)</a> we get:</p>
<div class="math notranslate nohighlight" id="equation-modif-upwind5">
<span class="eqno">(27)<a class="headerlink" href="#equation-modif-upwind5" title="Permalink to this equation">¶</a></span>\[v_{tt} =c^2 v_{xx}+\Delta t\Big(c v_{ttx} -t v_{ttt}\Big) + \Delta x \Big(\frac{|c|}{2} v_{xxt}  - c \frac{|c|}{2} v_{xxx} \Big) - \Delta^2 x \Big(\frac{c }{6} v_{xxxt} +\frac{c^{2} }{6}  v_{xxxx}\Big) +O(\Delta^2 t,\Delta^3 x)\]</div>
<p>Substituting equation <a class="reference internal" href="#equation-modif-upwind5">(27)</a> to equation <a class="reference internal" href="#equation-modif-upwind2">(24)</a> we have:</p>
<div class="math notranslate nohighlight" id="equation-modif-upwind-f">
<span class="eqno">(28)<a class="headerlink" href="#equation-modif-upwind-f" title="Permalink to this equation">¶</a></span>\[v_{t}+ c v_x  = \frac{c \Delta x}{2} \Big(Sign(c) - \frac{c \Delta t}{\Delta x}  \Big)v_{xx} +O(\Delta^2 t,\Delta^3 x)\]</div>
<p>Formally, <a class="reference internal" href="#equation-modif-upwind-f">(28)</a> is the PDE which actually solved by upwind method. As can be seen, the first term in the right hand side creates artificial diffusion for equation <a class="reference internal" href="#equation-adv-1d">(1)</a>
when solved numerically using upwind method. This shows that the upwind method creates numerical diffusion as wave propagates during time.
This equation also shows that the method is first order accurate. As we mentioned in equation <a class="reference internal" href="#equation-cfl-cond">(19)</a>, upwind method is stable if <span class="math notranslate nohighlight">\(|\frac{c \Delta t}{\Delta x}| \le 1\)</span>. This means that
the diffusion coefficient in equation <a class="reference internal" href="#equation-modif-upwind-f">(28)</a> <span class="math notranslate nohighlight">\(\frac{c \Delta x}{2} \Big(Sign(c) - \frac{c \Delta t}{\Delta x}\Big)\)</span> is positive.</p>
</div>
<div class="section" id="error-due-to-diffusion-and-dispersion">
<h4>Error due to Diffusion and Dispersion<a class="headerlink" href="#error-due-to-diffusion-and-dispersion" title="Permalink to this headline">¶</a></h4>
<p>Similar to von-Neumann stablity analysis, assume a wave-like solution of</p>
<div class="math notranslate nohighlight" id="equation-wave-ds">
<span class="eqno">(29)<a class="headerlink" href="#equation-wave-ds" title="Permalink to this equation">¶</a></span>\[\psi(x,t) = e^{i(kx-\omega t)} = e^{-i \phi_a}\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi_a\)</span> is the wave phase. Substituting equation <a class="reference internal" href="#equation-wave-ds">(29)</a> to <a class="reference internal" href="#equation-adv-1d">(1)</a>, we get <span class="math notranslate nohighlight">\(\omega (k)=ck\)</span> which corresponds to the relation between each
wave frequency and its wavenumber <span class="math notranslate nohighlight">\(k\)</span>. In general this relation is called dispersion.
if we use discretization of <span class="math notranslate nohighlight">\(x_{j}=j\Delta x\)</span> and <span class="math notranslate nohighlight">\(t_{n}=n\Delta t\)</span>, for <span class="math notranslate nohighlight">\((j,n=0,1,...)\)</span>, then the solution at  <span class="math notranslate nohighlight">\(x_j\)</span> at time <span class="math notranslate nohighlight">\(t_n\)</span>
is <span class="math notranslate nohighlight">\(\psi(x_j,t_n)\)</span>. We can now consider the analytical amplification factor:</p>
<div class="math notranslate nohighlight" id="equation-a-a-n">
<span class="eqno">(30)<a class="headerlink" href="#equation-a-a-n" title="Permalink to this equation">¶</a></span>\[A_a =\frac{\psi(x_j,t_{n+1})}{\psi(x_j,t_{n})}=e^{-i\omega \Delta t}\]</div>
<p>Then wave phase also can be calculate using <span class="math notranslate nohighlight">\(\omega (k)=ck\)</span> we have:</p>
<div class="math notranslate nohighlight" id="equation-phi-a">
<span class="eqno">(31)<a class="headerlink" href="#equation-phi-a" title="Permalink to this equation">¶</a></span>\[\phi_a = \omega \Delta t = c k \Delta t= CFL \times k \Delta x\]</div>
<p>Using equations <a class="reference internal" href="#equation-a-a-n">(30)</a> and <a class="reference internal" href="#equation-wave-ds">(29)</a>, one can show that:</p>
<div class="math notranslate nohighlight" id="equation-wave-disc">
<span class="eqno">(32)<a class="headerlink" href="#equation-wave-disc" title="Permalink to this equation">¶</a></span>\[\psi(x_j,t_n) = \psi_0 e^{i(kx-\omega t)} = \psi_0 A_a^n e^{i k x_j}\]</div>
<p>Since <span class="math notranslate nohighlight">\(\omega (k)=ck\)</span> for linear advection equation, we can calculate the phase and group velocity, namely:</p>
<div class="math notranslate nohighlight" id="equation-phase-v-ex">
<span class="eqno">(33)<a class="headerlink" href="#equation-phase-v-ex" title="Permalink to this equation">¶</a></span>\[V_p =\frac{\omega}{k}=\frac{ck}{k}=c\]</div>
<div class="math notranslate nohighlight" id="equation-group-v-ex">
<span class="eqno">(34)<a class="headerlink" href="#equation-group-v-ex" title="Permalink to this equation">¶</a></span>\[V_g =\frac{\partial \omega}{\partial k}=c\]</div>
<p>This shows that the phase and group velocity are the same, meaning that the wave is non-dispersive.</p>
<p>Now consider the upwind method and using the same termiology of equations <a class="reference internal" href="#equation-wave-disc">(32)</a> and <a class="reference internal" href="#equation-a-a-n">(30)</a>, we have:</p>
<div class="math notranslate nohighlight" id="equation-wave-disc-upw">
<span class="eqno">(35)<a class="headerlink" href="#equation-wave-disc-upw" title="Permalink to this equation">¶</a></span>\[\Psi(x_j,t_n) = \Psi_0 A^n e^{i k x_j}\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the numerical amplification factor and is defined as:</p>
<div class="math notranslate nohighlight" id="equation-a">
<span class="eqno">(36)<a class="headerlink" href="#equation-a" title="Permalink to this equation">¶</a></span>\[A = \frac{\Psi_j^{n+1}}{\Psi_j^{n}}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(A_a\)</span> is derived from the analytical solution of the PDE and that <span class="math notranslate nohighlight">\(A\)</span> is derived from
numerical approximation of the same PDE, which might not be in perfect agreement.
As we seen before, in the von-Neumann analysis of upwind method, <span class="math notranslate nohighlight">\(A\)</span>  was calculated in equation <a class="reference internal" href="#equation-upwind-aup">(16)</a>. We can compare <span class="math notranslate nohighlight">\(A_a\)</span> and
<span class="math notranslate nohighlight">\(A\)</span> by considering the ratio their norm:</p>
<div class="math notranslate nohighlight" id="equation-difer">
<span class="eqno">(37)<a class="headerlink" href="#equation-difer" title="Permalink to this equation">¶</a></span>\[\epsilon_A = \frac{|A|}{|A_a|}= \sqrt{1-4C(1-C)sin^2(\frac{k \Delta x}{2} )}=\sqrt{1-4C(1-C)sin^2(\frac{\chi}{2} )}\]</div>
<a class="reference internal image-reference" href="_images/ED.png"><img alt="alternate text" class="align-center" src="_images/ED.png" style="width: 500px; height: 400px;" /></a>
<p>In the figure above we can see  for different values of <span class="math notranslate nohighlight">\(C\)</span>, how <span class="math notranslate nohighlight">\(\epsilon_A\)</span> changed as the frequency increases. As can be seen for <span class="math notranslate nohighlight">\(C=1\)</span>,
both analytical and numerical amplification magnitude are the same and equal to 1. This is the case that numerical solution is the exact solution of the advection equation.
However, as <span class="math notranslate nohighlight">\(C\)</span> decreases, for higher frequencies, <span class="math notranslate nohighlight">\(\epsilon_A\)</span> decreases dramatically, meaning that the numerical amplitude is smaller than the exact one.</p>
<p>We can also do the same analysis for the phase which is associated to dispersion. Defining <span class="math notranslate nohighlight">\(\epsilon_\phi\)</span> as the ratio between the numerical and analytical phase,
and using equation <a class="reference internal" href="#equation-upwind-aup">(16)</a>, we have</p>
<div class="math notranslate nohighlight" id="equation-phier">
<span class="eqno">(38)<a class="headerlink" href="#equation-phier" title="Permalink to this equation">¶</a></span>\[\epsilon_\phi = \frac{|\phi|}{|\phi_a|}= \frac{1}{C \chi} \frac{C sin(\chi)}{1-C (1-cos(\chi)}\]</div>
<a class="reference internal image-reference" href="_images/EPHI.png"><img alt="alternate text" class="align-center" src="_images/EPHI.png" style="width: 500px; height: 400px;" /></a>
<p>In the figure above we can see for different values of <span class="math notranslate nohighlight">\(C\)</span>, how <span class="math notranslate nohighlight">\(\epsilon_\phi\)</span> changed as the frequency increases. As can be seen, there is no dispersion error for <span class="math notranslate nohighlight">\(C=1\)</span>
and <span class="math notranslate nohighlight">\(C=0.5\)</span>. for the values of <span class="math notranslate nohighlight">\(C&lt;0.5\)</span>, <span class="math notranslate nohighlight">\(\epsilon_\phi&lt;1\)</span> meaning that the numerical solution moves slower than the physical one. On the other hand for <span class="math notranslate nohighlight">\(C&gt;0.5\)</span>, this
is vice versa.</p>
</div>
<div class="section" id="method-of-lines">
<h4>Method of lines<a class="headerlink" href="#method-of-lines" title="Permalink to this headline">¶</a></h4>
<p>The numerical method of lines (MOL) is a technique for solving PDEs. In this method we discretize all but one dimension (for example temporal terms) and
then integrate the semi-discrete problem as a system of ODEs or DAEs. For using this method, the PDE problem should be well posed as an initial value
problem in at least one dimension, since the ODE and DAE integrators used are initial value in problem solvers. For this reason MOL cannot be used directly on purely elliptic
partial differential equations, such as Laplace’s equation. However for solving Laplace’s equation using MOL, “method of false transients” can be applied or “semi-analytical method of lines” can
be used.</p>
<p>For simplicity, let us assume equation <a class="reference internal" href="#equation-adv-1d">(1)</a> with <span class="math notranslate nohighlight">\(c&gt;0\)</span>. Then the semi discretization of this equation using backward spatial descritization is:</p>
<div class="math notranslate nohighlight" id="equation-semi-d">
<span class="eqno">(39)<a class="headerlink" href="#equation-semi-d" title="Permalink to this equation">¶</a></span>\[u_t =- c \frac{u_{i}^{n}-u_{i-1}^{n}}{ \Delta x}\]</div>
<p>We have wide range of ODE solvers in Matlab, Julia and python, which we use some of them here.</p>
</div>
<div class="section" id="python-code-using-mol">
<h4>Python Code (Using MOL)<a class="headerlink" href="#python-code-using-mol" title="Permalink to this headline">¶</a></h4>
<p>Here is a python code for modeling the 1D linear advection equation using MOL.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c1"># function specifing the rhs of MOL</span>
<span class="k">def</span> <span class="nf">rhs</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">A</span><span class="p">):</span>
    <span class="n">N</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="n">x0</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="n">xN</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="n">c</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> 
    <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
    <span class="n">dx</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">dudt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>    
    <span class="c1"># Periodic boundary condition </span>
    <span class="n">dudt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=-</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span> 
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> 
        <span class="n">dudt</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=-</span> <span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="n">dudt</span>

<span class="n">T</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span>
<span class="n">tspan</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>

<span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">xN</span><span class="o">=</span><span class="mf">10.</span><span class="p">;</span><span class="n">c</span><span class="o">=</span><span class="mf">1.</span><span class="p">;</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="c1"># Parameters of ODE system </span>
<span class="n">A</span><span class="o">=</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">x0</span> <span class="p">,</span><span class="n">xN</span> <span class="p">,</span><span class="n">c</span><span class="p">];</span>

<span class="c1"># Exact solution</span>
<span class="n">uexc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">T</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">T</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>
<span class="c1"># Initial value</span>
<span class="n">u0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>
<span class="c1"># Solving ODE</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="p">,))</span>
 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Initial value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># ploting the last solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Solution at t=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<span class="c1"># ploting the last solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">uexc</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact solution at t= &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;semi-LA1D_Python.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p>For the explanaition of the code, please take a look at the youtube video.</p>
<a class="reference internal image-reference" href="_images/semi-LA1D_Python.png"><img alt="alternate text" class="align-center" src="_images/semi-LA1D_Python.png" style="width: 500px; height: 400px;" /></a>
</div>
<div class="section" id="matlab-code-using-mol">
<h4>Matlab Code (Using MOL)<a class="headerlink" href="#matlab-code-using-mol" title="Permalink to this headline">¶</a></h4>
<p>Here is a Matlab code for modeling the 1D linear advection equation using MOL.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="nf">Semi_LA1D_Matlab</span>
<span class="n">clc</span>
<span class="n">T</span><span class="p">=</span><span class="mf">0.5</span><span class="p">;</span>
<span class="n">N</span><span class="p">=</span><span class="mi">100</span><span class="p">;</span><span class="n">x0</span><span class="p">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">xN</span><span class="p">=</span><span class="mf">10.</span><span class="p">;</span><span class="n">c</span><span class="p">=</span><span class="mf">1.</span><span class="p">;</span>
<span class="n">x</span><span class="p">=</span><span class="nb">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>

<span class="c">% Parameters of ODE system </span>
<span class="n">A</span><span class="p">=[</span><span class="n">N</span> <span class="n">x0</span> <span class="n">xN</span> <span class="n">c</span><span class="p">];</span>

<span class="c">% Exact solution</span>
<span class="n">uexc</span><span class="p">=</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">T</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">T</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>

<span class="c">% Temporal solving range</span>
<span class="n">tspan</span><span class="p">=[</span><span class="mi">0</span> <span class="n">T</span><span class="p">];</span>
<span class="c">% Initial value</span>
<span class="n">u0</span><span class="p">=</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>
<span class="c">% Solving ODE</span>
<span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">u</span><span class="p">]=</span><span class="n">ode45</span><span class="p">(@(</span><span class="n">t</span><span class="p">,</span><span class="n">u</span><span class="p">)</span> <span class="n">rhs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">A</span><span class="p">),</span><span class="n">tspan</span><span class="p">,</span><span class="n">u0</span><span class="p">);</span>
<span class="c">% Ploting initial value, exact sol. and numerical sol.</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u0</span><span class="p">);</span>
<span class="n">hold</span> <span class="n">on</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="k">end</span><span class="p">,:));</span> 
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">uexc</span><span class="p">);</span> 
<span class="n">axis</span><span class="p">([</span><span class="mi">0</span> <span class="mf">10.1</span>  <span class="mi">0</span> <span class="mf">1.1</span><span class="p">])</span> 
<span class="n">xlabel</span><span class="p">(</span>&quot;<span class="n">x</span>&quot;<span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span>&quot;<span class="n">u</span>&quot;<span class="p">)</span>
<span class="n">grid</span> <span class="n">on</span>

<span class="n">legend</span><span class="p">({</span>&quot;<span class="n">Initial</span> <span class="n">value</span>&quot;<span class="p">,</span><span class="n">strcat</span><span class="p">(</span>&quot;<span class="n">Solution</span> <span class="n">at</span> <span class="n">t</span><span class="p">=</span>&quot;<span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">T</span><span class="p">)),</span><span class="n">strcat</span><span class="p">(</span>&quot;<span class="n">Exact</span> <span class="n">Solution</span> <span class="n">at</span> <span class="n">t</span><span class="p">=</span>&quot;<span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">T</span><span class="p">))},</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;east&#39;</span><span class="p">)</span>
     
<span class="c">% function specifing the rhs of MOL</span>
<span class="k">    function</span><span class="w"> </span>dudt<span class="p">=</span><span class="nf">rhs</span><span class="p">(</span>t,u,A<span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">N</span><span class="p">=</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="n">x0</span><span class="p">=</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="n">xN</span><span class="p">=</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">c</span><span class="p">=</span><span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> 
        <span class="n">x</span><span class="p">=</span><span class="nb">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
        <span class="n">dx</span><span class="p">=</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="c">% Periodic boundary condition </span>
        <span class="n">dudt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)=</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">u</span><span class="p">(</span><span class="n">N</span><span class="p">))</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">=</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span> 
            <span class="n">dudt</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span><span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">u</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span>
        <span class="k">end</span>
 
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>For the explanaition of the code, please take a look at the youtube video.</p>
<a class="reference internal image-reference" href="_images/semi-LA1D_Matlab.png"><img alt="alternate text" class="align-center" src="_images/semi-LA1D_Matlab.png" style="width: 500px; height: 400px;" /></a>
</div>
<div class="section" id="julia-code-using-mol">
<h4>Julia Code (Using MOL)<a class="headerlink" href="#julia-code-using-mol" title="Permalink to this headline">¶</a></h4>
<p>Here is a Julia code for modeling the 1D linear advection equation using MOL.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">DifferentialEquations</span>
<span class="k">using</span> <span class="n">PyPlot</span>

<span class="c"># function specifing the rhs of MOL</span>
<span class="k">function</span> <span class="n">rhs</span><span class="p">(</span><span class="n">dudt</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">A</span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span><span class="n">t</span><span class="p">)</span>
    <span class="n">N</span><span class="o">=</span><span class="kt">Integer</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="n">x0</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="n">xN</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="n">c</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> 
    <span class="n">x</span><span class="o">=</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
    <span class="n">dx</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="c"># Periodic boundary condition </span>
    <span class="n">dudt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="n">N</span><span class="p">])</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span> 
    <span class="k">for</span> <span class="n">n</span> <span class="kp">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dudt</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=-</span> <span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span>
    <span class="k">end</span>   
<span class="k">end</span>

<span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">xN</span><span class="o">=</span><span class="mf">10.</span><span class="p">;</span><span class="n">c</span><span class="o">=</span><span class="mf">1.</span><span class="p">;</span>
<span class="n">T</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span>

<span class="c"># Parameters of ODE system </span>
<span class="n">A</span><span class="o">=</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">x0</span> <span class="p">,</span><span class="n">xN</span> <span class="p">,</span><span class="n">c</span><span class="p">];</span>

<span class="n">x</span><span class="o">=</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">xN</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>

<span class="c"># Exact solution</span>
<span class="n">uexc</span><span class="o">=</span><span class="n">exp</span><span class="o">.</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">T</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">T</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>
<span class="c"># Initial value</span>
<span class="n">u0</span><span class="o">=</span><span class="n">exp</span><span class="o">.</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>

<span class="c"># Problem definition of ODE in Julia</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">ODEProblem</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="n">u0</span><span class="p">,</span><span class="n">tspan</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>

<span class="c"># Solving ODE</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span><span class="n">saveat</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">PyPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Initial value&quot;</span><span class="p">)</span>     
<span class="n">PyPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sol</span><span class="p">[</span><span class="k">end</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;Solution at t= &quot;</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
<span class="n">PyPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">uexc</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;Exact solution at t= &quot;</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
<span class="n">PyPlot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">PyPlot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s">&quot;dotted&quot;</span><span class="p">)</span>
<span class="n">PyPlot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">PyPlot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For the explanaition of the code, please take a look at the youtube video.</p>
<a class="reference internal image-reference" href="_images/semi-LA1D_Julia.png"><img alt="alternate text" class="align-center" src="_images/semi-LA1D_Julia.png" style="width: 500px; height: 400px;" /></a>
</div>
</div>
<div class="section" id="lax-wendroff-method">
<h3>Lax-Wendroff Method<a class="headerlink" href="#lax-wendroff-method" title="Permalink to this headline">¶</a></h3>
<p>Lax-Wendroff method belongs to the class of conservative schemes. As we can see later, this method provide a second order (in time and space) numerical solution.
There are many ways to derive this method. We use one of these methods. Our main aim is to find the numerical solution at <span class="math notranslate nohighlight">\(t=t_n+1\)</span> knowing solution at <span class="math notranslate nohighlight">\(t=t_n\)</span>.
For this reason we write the taylor expansion of <span class="math notranslate nohighlight">\(u(x,t+\Delta t)\)</span> with respect to time, namely:</p>
<div class="math notranslate nohighlight" id="equation-taylor-lax">
<span class="eqno">(40)<a class="headerlink" href="#equation-taylor-lax" title="Permalink to this equation">¶</a></span>\[u(x,t+\Delta t) = u(x,t) + \Delta t u_{t}(x,t) + \frac{\Delta^2 t}{2} u_{tt}(x,t) + O(\Delta^3 t)\]</div>
<p>But from equation <a class="reference internal" href="#equation-adv-1d">(1)</a> we know that <span class="math notranslate nohighlight">\(\partial_{t}=-c\partial_{x}\)</span>, thus we can substitude this expression in equation <a class="reference internal" href="#equation-taylor-lax">(40)</a> and we get:</p>
<div class="math notranslate nohighlight" id="equation-taylor-lax1">
<span class="eqno">(41)<a class="headerlink" href="#equation-taylor-lax1" title="Permalink to this equation">¶</a></span>\[u(x,t+\Delta t) = u(x,t) -a \Delta t u_{x}(x,t) +a^2 \frac{\Delta^2 t}{2} u_{xx}(x,t) + O(\Delta^3 t)\]</div>
<p>Now we can spatially approximate equation <a class="reference internal" href="#equation-taylor-lax1">(41)</a> using central difference scheme for <span class="math notranslate nohighlight">\(u_{x}(x,t)\)</span> and <span class="math notranslate nohighlight">\(u_{xx}(x,t)\)</span> which results in:</p>
<div class="math notranslate nohighlight" id="equation-lax-w">
<span class="eqno">(42)<a class="headerlink" href="#equation-lax-w" title="Permalink to this equation">¶</a></span>\[u_{i}^{n+1} = a_{-1} u_{i-1}^{n} + a_{0} u_{i}^{n} +a_{1}  u_{i+1}^{n}\]</div>
<p>where <span class="math notranslate nohighlight">\(a_{-1}=\frac{1}{2}C(1+C)\)</span>, <span class="math notranslate nohighlight">\(a_{0}=1-C^2\)</span>, <span class="math notranslate nohighlight">\(a_{1}=\frac{-1}{2}C(1-C)\)</span> and <span class="math notranslate nohighlight">\(C=\frac{c \Delta t}{\Delta x}\)</span>.</p>
<p>Similar to upwind method, we can rewrite equation <a class="reference internal" href="#equation-lax-w">(42)</a> in its matrix form</p>
<div class="math notranslate nohighlight" id="equation-matrixa-lax">
<span class="eqno">(43)<a class="headerlink" href="#equation-matrixa-lax" title="Permalink to this equation">¶</a></span>\[\begin{split} \small\mathbf{A}=\small\begin{bmatrix}
 a_{0} &amp; a_{1} &amp; 0 &amp; 0 &amp; 0&amp; ... &amp; a_{-1} \\
 a_{-1} &amp; a_{0} &amp; a_{1}&amp; 0 &amp; 0 &amp;... &amp; 0 \\
 0 &amp; a_{-1} &amp; a_{0} &amp; a_{1}&amp; 0 &amp;... &amp; 0 \\
  \vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp;  \ddots &amp; \vdots &amp; \vdots \\
 0 &amp;0 &amp;... &amp; a_{-1} &amp; a_{0} &amp; a_{1} &amp; 0 \\
 0 &amp;0 &amp;... &amp; 0 &amp; a_{-1} &amp; a_{0} &amp; a_{1}  \\
 a_{1}  &amp;0 &amp;... &amp; 0 &amp; 0&amp;  a_{-1} &amp; a_{0}  \\
 \end{bmatrix}_{N\times N }\end{split}\]</div>
<div class="section" id="id2">
<h4>Stability And Accuracy<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Using the same idea from FTCS section, we calculate the <span class="math notranslate nohighlight">\(A\)</span> for Lax-Wendroff method:</p>
<div class="math notranslate nohighlight" id="equation-lax-au">
<span class="eqno">(44)<a class="headerlink" href="#equation-lax-au" title="Permalink to this equation">¶</a></span>\[A = a_{0}+ a_{-1} e^{-ik \Delta x}+ a_{1} e^{ik \Delta x}\]</div>
<p>Now calculating its norm, one can show that we have:</p>
<div class="math notranslate nohighlight" id="equation-lax-a2">
<span class="eqno">(45)<a class="headerlink" href="#equation-lax-a2" title="Permalink to this equation">¶</a></span>\[|A|^2 = 1 - 4 C^2 (1-C^2)sin^4(\frac{\chi}{2})\]</div>
<p>Where <span class="math notranslate nohighlight">\(\chi=k \Delta x\)</span>. The method is stable if <span class="math notranslate nohighlight">\(|A| \leq 1\)</span> which leads to</p>
<div class="math notranslate nohighlight" id="equation-cfl-cond-lax">
<span class="eqno">(46)<a class="headerlink" href="#equation-cfl-cond-lax" title="Permalink to this equation">¶</a></span>\[|\frac{c \Delta t}{\Delta x}| \leq 1\]</div>
<p>Thus this method is conditionally stable.</p>
</div>
<div class="section" id="python-code-using-matrix-form">
<h4>Python Code (Using Matrix form)<a class="headerlink" href="#python-code-using-matrix-form" title="Permalink to this headline">¶</a></h4>
<p>For the code, we just need to modify the ::UpwindMatrixAssembly:: the 1DLinearAdvection class and also in the main code in the upwind Python code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  
<span class="k">def</span> <span class="nf">LaxWendroffMatrixAssembly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
   <span class="n">C</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">();</span>
   <span class="n">aleft</span><span class="o">=</span><span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">C</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">;</span>
   <span class="n">amid</span><span class="o">=</span><span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">C</span><span class="o">*</span><span class="n">C</span><span class="p">);</span>
   <span class="n">aright</span><span class="o">=</span><span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">;</span>
   <span class="n">a1</span><span class="o">=</span><span class="p">[</span><span class="n">aleft</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">a2</span><span class="o">=</span><span class="p">[</span><span class="n">amid</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
   <span class="n">a3</span><span class="o">=</span><span class="p">[</span><span class="n">aright</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">aleft</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">aright</span>  
       
  
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculating solution if CFL&lt;=1</span>
<span class="k">if</span> <span class="p">(</span><span class="n">LA1D</span><span class="o">.</span><span class="n">checkCFL</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;CFL number is: &quot;</span><span class="p">,</span> <span class="n">LA1D</span><span class="o">.</span><span class="n">CFL</span><span class="p">())</span>
    <span class="n">LA1D</span><span class="o">.</span><span class="n">LaxWendroffMatrixAssembly</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">LA1D</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">LA1D</span><span class="o">.</span><span class="n">deltaT</span><span class="p">)):</span>
        <span class="n">u</span><span class="o">=</span><span class="n">LA1D</span><span class="o">.</span><span class="n">Solve</span><span class="p">(</span><span class="n">u0</span><span class="p">)</span>
        <span class="n">u0</span><span class="o">=</span><span class="n">u</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;CFL number is greater than 1. CFL: &quot;</span><span class="p">,</span> <span class="n">LA1D</span><span class="o">.</span><span class="n">CFL</span><span class="p">())</span>
</pre></div>
</div>
<p>For the explanaition of the code, please take a look at the youtube video.</p>
<a class="reference internal image-reference" href="_images/LA1D_laxWendroff_Python.png"><img alt="alternate text" class="align-center" src="_images/LA1D_laxWendroff_Python.png" style="width: 500px; height: 400px;" /></a>
</div>
<div class="section" id="matlab-code-using-matrix-form">
<h4>Matlab Code (Using Matrix form)<a class="headerlink" href="#matlab-code-using-matrix-form" title="Permalink to this headline">¶</a></h4>
<p>For the code, we just need to modify the ::UpwindMatrixAssembly:: the 1DLinearAdvection class and also in the main code in the upwind Matlab code.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">LaxWendroffMatrixAssembly</span><span class="p">(</span>self<span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">C</span><span class="p">=</span><span class="n">self</span><span class="p">.</span><span class="n">CFL</span><span class="p">();</span>
   <span class="n">aleft</span><span class="p">=</span><span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">C</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">;</span>
   <span class="n">amid</span><span class="p">=</span><span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">C</span><span class="o">*</span><span class="n">C</span><span class="p">);</span>
   <span class="n">aright</span><span class="p">=</span><span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">;</span>
   <span class="n">a1</span><span class="p">=</span><span class="n">aleft</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">a2</span><span class="p">=</span><span class="n">amid</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">N</span><span class="p">);</span>
   <span class="n">a3</span><span class="p">=</span><span class="n">aright</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
   <span class="n">self</span><span class="p">.</span><span class="n">A</span><span class="p">=</span><span class="nb">diag</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">diag</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="nb">diag</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">self</span><span class="p">.</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="k">end</span><span class="p">)=</span><span class="n">aleft</span><span class="p">;</span>
   <span class="n">self</span><span class="p">.</span><span class="n">A</span><span class="p">(</span><span class="k">end</span><span class="p">,</span><span class="mi">1</span><span class="p">)=</span><span class="n">aright</span><span class="p">;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span> 
<span class="c">% calculating solution if CFL&lt;=1</span>
<span class="k">if</span> <span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">checkCFL</span><span class="p">()</span><span class="o">==</span> <span class="n">true</span><span class="p">)</span>
    <span class="nb">disp</span><span class="p">(</span><span class="n">strcat</span><span class="p">(</span>&quot;<span class="n">CFL</span> <span class="n">number</span> <span class="n">is</span><span class="p">:</span> &quot;<span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">CFL</span><span class="p">())))</span>
    <span class="n">LA1D</span><span class="p">.</span><span class="n">LaxWendroffMatrixAssembly</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">t</span><span class="p">=</span><span class="mi">0</span><span class="p">:</span><span class="n">uint8</span><span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">T</span><span class="o">/</span><span class="n">LA1D</span><span class="p">.</span><span class="n">deltaT</span><span class="p">)</span>
        <span class="n">u</span><span class="p">=</span><span class="n">LA1D</span><span class="p">.</span><span class="n">Solve</span><span class="p">(</span><span class="n">u0</span><span class="p">);</span>
        <span class="n">u0</span><span class="p">=</span><span class="n">u</span><span class="p">;</span>
    <span class="k">end</span>
<span class="k">else</span>
    <span class="nb">disp</span><span class="p">(</span><span class="n">strcat</span><span class="p">(</span>&quot;<span class="n">CFL</span> <span class="n">number</span> <span class="n">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">1.</span> <span class="n">CFL</span><span class="p">:</span> &quot;<span class="p">,</span><span class="n">num2str</span><span class="p">(</span><span class="n">LA1D</span><span class="p">.</span><span class="n">CFL</span><span class="p">())))</span>
<span class="k">end</span>

 
</pre></div>
</div>
<p>For the explanaition of the code, please take a look at the youtube video.</p>
<a class="reference internal image-reference" href="_images/LA1D_laxWendroff_Matlab.png"><img alt="alternate text" class="align-center" src="_images/LA1D_laxWendroff_Matlab.png" style="width: 500px; height: 400px;" /></a>
</div>
<div class="section" id="julia-code-using-matrix-form">
<h4>Julia Code (Using Matrix form)<a class="headerlink" href="#julia-code-using-matrix-form" title="Permalink to this headline">¶</a></h4>
<p>For the code, we just need to modify the ::UpwindMatrixAssembly:: the 1DLinearAdvection type and also in the main code in the upwind Julia code.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">self</span><span class="o">.</span><span class="n">LaxWendroffMatrixAssembly</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span> 
	<span class="n">C</span><span class="o">=</span><span class="n">self</span><span class="o">.</span><span class="n">CFL</span><span class="p">();</span>
	<span class="n">aleft</span><span class="o">=</span><span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">C</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">;</span>
	<span class="n">amid</span><span class="o">=</span><span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">C</span><span class="o">*</span><span class="n">C</span><span class="p">);</span>
	<span class="n">aright</span><span class="o">=</span><span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">;</span> 
	<span class="n">a1</span><span class="o">=</span><span class="p">[</span><span class="n">aleft</span> <span class="k">for</span> <span class="n">n</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">a2</span><span class="o">=</span><span class="p">[</span><span class="n">amid</span> <span class="k">for</span> <span class="n">n</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="p">]</span>
	<span class="n">a3</span><span class="o">=</span><span class="p">[</span><span class="n">aright</span> <span class="k">for</span> <span class="n">n</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">A</span><span class="o">=</span><span class="kt">Tridiagonal</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">)</span><span class="o">+</span><span class="n">zeros</span><span class="p">(</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span><span class="n">self</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
	<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="k">end</span><span class="p">]</span><span class="o">=</span><span class="n">aleft</span>
	<span class="n">A</span><span class="p">[</span><span class="k">end</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">aright</span>
	<span class="k">return</span> <span class="n">A</span>
<span class="k">end</span>

<span class="n">self</span><span class="o">.</span><span class="n">Solve</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">u0</span><span class="o">::</span><span class="kt">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">})</span>
	 <span class="k">return</span> <span class="n">self</span><span class="o">.</span><span class="n">LaxWendroffMatrixAssembly</span><span class="p">()</span><span class="o">*</span><span class="n">u0</span>
<span class="k">end</span>        
</pre></div>
</div>
<p>For the explanaition of the code, please take a look at the youtube video.</p>
<a class="reference internal image-reference" href="_images/LA1D_laxWendroff_Julia.png"><img alt="alternate text" class="align-center" src="_images/LA1D_laxWendroff_Julia.png" style="width: 500px; height: 400px;" /></a>
</div>
<div class="section" id="id3">
<h4>Modified Equation<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Similar to previous section, considering equation <a class="reference internal" href="#equation-lax-w">(42)</a>, the modified equation refers to the following formal equation:</p>
<div class="math notranslate nohighlight" id="equation-lax-w-modified1">
<span class="eqno">(47)<a class="headerlink" href="#equation-lax-w-modified1" title="Permalink to this equation">¶</a></span>\[v(x,t+\Delta t) = a_{-1} v(x-\Delta x,t) + a_{0} v(x,t) + a_{1}v(x+\Delta x,t)\]</div>
<p>Similar to previous section one can write the taylor expansion of each term and replace the temporal term by spatial terms and end up with the following:</p>
<div class="math notranslate nohighlight" id="equation-lax-w-modified">
<span class="eqno">(48)<a class="headerlink" href="#equation-lax-w-modified" title="Permalink to this equation">¶</a></span>\[v_{t}= \frac{\Delta x}{6}(C^2 - 1) v_{xxx}+ O(\Delta^3 x,\Delta^3 t)\]</div>
<p>This shows that lax-Wendroff is second order accurate in time and space. Note that there is no diffusion term and only dispersion term can be seen here.</p>
</div>
<div class="section" id="id4">
<h4>Error due to Diffusion and Dispersion<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Similar to previous section we can analysis the behavior of numerical solution by analysing <span class="math notranslate nohighlight">\(\epsilon_A\)</span> and <span class="math notranslate nohighlight">\(\epsilon_\phi\)</span>.
As we seen before, in the von-Neumann analysis of upwind method, <span class="math notranslate nohighlight">\(A\)</span>  was calculated in equation <a class="reference internal" href="#equation-lax-au">(44)</a>. Thus we can calculate <span class="math notranslate nohighlight">\(\epsilon_A\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-difer2">
<span class="eqno">(49)<a class="headerlink" href="#equation-difer2" title="Permalink to this equation">¶</a></span>\[\epsilon_A = \frac{|A|}{|A_a|}= \sqrt{1 - 4 C^2 (1-C^2)sin^4(\frac{\chi}{2})}\]</div>
<a class="reference internal image-reference" href="_images/ED-Lax-Wendroff.png"><img alt="alternate text" class="align-center" src="_images/ED-Lax-Wendroff.png" style="width: 500px; height: 400px;" /></a>
<p>As can be seen here,</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="licence.html" class="btn btn-neutral float-right" title="licence" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to Diff. Academy’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Peyman Davvalo Khongar.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>